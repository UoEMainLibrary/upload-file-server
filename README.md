# HTTP upload file server in Flask

This is a simple (188 line) Flask server that accepts http post requests to
`http://[hostname]/api` and saves the submitted file(s) in a subdirectory of
`UPLOAD_PATH` named `"%d-%m-%y_%number"` where: %d: day of the month, %m: month,
%y: year and %number is a value passed in the submitted form to uniquely identify
the submission. An example would be
`home/hrafn/PycharmProjects/upload-file-server/upload/08-05-2020_58`. The
%number is generated by incrementing the last numbered folder created that day by
one.

Files can be uploaded in steps, after the first file upload a uid is passed to
the client which is used to id the client in that session. Validation checks are
done on the uid and file name(s) passed between for security reasons. 

The server also accepts GETs to `http://[hostname]/recaptcha` for server-side
validation of reCaptcha requests (the site key has been omitted from the URL).

Finally the server will send email notifications to the an admin as well as the
email address provided in the form.

Flask-Cors is added to allowed cross-origin requests and responses (mainly intended
for development).

This runs on Python 2/3. The only dependencies are:

* [Flask](https://flask.palletsprojects.com/en/1.1.x/)
* [Flask-Cors](https://flask-cors.readthedocs.io/en/latest/)
* [Requests](https://requests.readthedocs.io/en/master/) (only for reCaptcha)

## Installation
1. Clone the repo.
2. Activate virtualenv (`source venv/bin/activate`)
3. Install requirements (`pip install -r requirements.txt`) 
4. Run the server (`python3 main.py`)

## Notes
I might have been hurrying but it seems to me that if you **start** by trying to access anything in
`request.files` ([see manual](https://flask.palletsprojects.com/en/1.1.x/api/#flask.Request.files))
other than using the key `"file"` then Flask will respond with a 400. If so, this is a Flask bug,
but I can't be bothered with reproducing it. Therefore, the assumption that I go by is that the
request will contain the first file under the key `"file"`.

